{
  "hash": "94cf97156d80ac701a28e9803a335770",
  "result": {
    "markdown": "---\ntitle: Coexpression analysis\nformat:\n  html: default\n  ipynb: default\nexecute:\n  cache: true\n  keep-ipynb: true\n---\n\n## Introduction\n\nWhile [BioFindr.jl][1] is developed primarily for causal inference from genomics and transcriptomics data, coexpression analysis of transcriptomics data alone is also possible. In coexpression analysis, pairwise correlation is used as a simple measure for the probability of two genes being functionally related either through direct or indirect regulation, or through coregulation by a third factor. In [BioFindr.jl][1], significance of pairwise correlation is computed using a gene-specific background distribution, allowing for genes having different biological roles. For instance, it is known that many biological networks are [scale-free](https://en.wikipedia.org/wiki/Scale-free_network), where a small number of so-called \"hub genes\" have a high number of interaction partners while most other genes only have few. In [BioFindr.jl][1], this is accomodated by modelling the distribution of correlation values between a given gene $A$ and all other genes $B$ as a [mixture distribution](https://en.wikipedia.org/wiki/Mixture_distribution) of real and null (random) correlations. The relative weight of each component reflects the prior probability of finding a non-null $B$ gene for a given $A$ gene, and is fitted for every $A$ gene separately.\n\nWe will illustrate how to run coexpression analysis with [BioFindr.jl][1] using [preprocessed data][2] from the [GEUVADIS study][3]. See the [installation instructions](installation.qmd) for the steps you need to take to reproduce this tutorial.\n\n## Set up the environment\n\nWe begin by setting up the environment and loading some necessary packages.\n\n::: {#f8f0b37a .cell execution_count=1}\n``` {.julia .cell-code}\nusing DrWatson\nquickactivate(@__DIR__)\n\nusing DataFrames\nusing Arrow\nusing Markdown\n\nusing BioFindr\n```\n:::\n\n\n## Load expression data\n\n[BioFindr.jl][1] expects that expression data are stored in a [DataFrame][4] where columns correspond to variables (genes) and rows to samples. An expression [DataFrame][4] should not contain any other columns (e.g. gene annotation) than gene expression columns, and gene expression data should be stored as [floating-point numbers](https://docs.julialang.org/en/v1/manual/integers-and-floating-point-numbers/). Internally, [BioFindr.jl][1] operates on matrices, and if you have an expression [DataFrame][4] `df`, then `Matrix(df)` should return a matrix of floats.\n\nAt the moment, [BioFindr.jl][1] does not support count-based expression data being provided as a [DataFrame][4] of integers. This is not an intrinsic limitation of the method, but simply to distinguish expression data from integer-valued genotype data. Future versions will remove this limitation by supporting [scientific types](https://juliaai.github.io/ScientificTypes.jl/dev/).\n\nThis tutorial uses two tables of expression data from the same set of samples, one for mRNA expression data called `dt`, and one for microRNA (miRNA) expression data called `dm`:\n\n::: {#cf6b4543 .cell execution_count=2}\n``` {.julia .cell-code}\ndt = DataFrame(Arrow.Table(datadir(\"exp_pro\",\"findr-data-geuvadis\", \"dt.arrow\")));\ndm = DataFrame(Arrow.Table(datadir(\"exp_pro\",\"findr-data-geuvadis\", \"dm.arrow\")));\n```\n:::\n\n\n::: {#082ec53f .cell execution_count=3}\n\n::: {.cell-output .cell-output-display execution_count=4}\nThe mRNA data has expression data for 23722 genes in 360 samples, while miRNA data is available for 674 miRNAs in the same 360 samples.\n\n:::\n:::\n\n\nWe can confirm that the data frames are of the right type:\n\n::: {#54ab75e8 .cell execution_count=4}\n``` {.julia .cell-code}\n[typeof(Matrix(dt)) typeof(Matrix(dm))]\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n1×2 Matrix{DataType}:\n Matrix{Float64}  Matrix{Float64}\n```\n:::\n:::\n\n\n## Run BioFindr.jl\n\n### All-vs-all coexpression analysis\n\nThe simplest type of coexpression analysis tests for non-zero correlation among all possible pairs in a gene expression dataset. Let's do this for the miRNA data:\n\n::: {#94dc757f .cell execution_count=5}\n``` {.julia .cell-code}\ndP_mir_all = findr(dm, FDR=0.05)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div><div style = \"float: left;\"><span>28378×4 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">28353 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Source</th><th style = \"text-align: left;\">Target</th><th style = \"text-align: left;\">Probability</th><th style = \"text-align: left;\">qvalue</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">hsa-miR-574-3p</td><td style = \"text-align: left;\">hsa-miR-574-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">hsa-miR-4482-1-3p</td><td style = \"text-align: left;\">hsa-miR-1304-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">hsa-miR-3667-5p</td><td style = \"text-align: left;\">hsa-miR-3667-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">hsa-miR-550a-2-5p</td><td style = \"text-align: left;\">hsa-miR-550a-2-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">hsa-miR-550a-2-5p</td><td style = \"text-align: left;\">hsa-miR-550a-3-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">hsa-miR-3130-2-5p</td><td style = \"text-align: left;\">hsa-miR-3130-1-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">hsa-let-7b-5p</td><td style = \"text-align: left;\">hsa-let-7b-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">hsa-miR-96-5p</td><td style = \"text-align: left;\">hsa-miR-182-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">hsa-miR-96-5p</td><td style = \"text-align: left;\">hsa-miR-1271-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">hsa-miR-3667-3p</td><td style = \"text-align: left;\">hsa-miR-3667-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">hsa-miR-181c-5p</td><td style = \"text-align: left;\">hsa-miR-181c-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">hsa-miR-181c-5p</td><td style = \"text-align: left;\">hsa-miR-181d-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">hsa-miR-335-5p</td><td style = \"text-align: left;\">hsa-miR-335-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28367</td><td style = \"text-align: left;\">hsa-miR-410-3p</td><td style = \"text-align: left;\">hsa-miR-7-3-5p</td><td style = \"text-align: right;\">0.84803</td><td style = \"text-align: right;\">0.0499585</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28368</td><td style = \"text-align: left;\">hsa-miR-152-3p</td><td style = \"text-align: left;\">hsa-miR-181a-1-5p</td><td style = \"text-align: right;\">0.848014</td><td style = \"text-align: right;\">0.0499621</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28369</td><td style = \"text-align: left;\">hsa-let-7f-2-3p</td><td style = \"text-align: left;\">hsa-miR-4446-3p</td><td style = \"text-align: right;\">0.848008</td><td style = \"text-align: right;\">0.0499657</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28370</td><td style = \"text-align: left;\">hsa-miR-181a-1-3p</td><td style = \"text-align: left;\">hsa-miR-99b-5p</td><td style = \"text-align: right;\">0.847993</td><td style = \"text-align: right;\">0.0499693</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28371</td><td style = \"text-align: left;\">hsa-miR-330-5p</td><td style = \"text-align: left;\">hsa-miR-296-5p</td><td style = \"text-align: right;\">0.84799</td><td style = \"text-align: right;\">0.0499729</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28372</td><td style = \"text-align: left;\">hsa-miR-1307-5p</td><td style = \"text-align: left;\">hsa-miR-32-3p</td><td style = \"text-align: right;\">0.847985</td><td style = \"text-align: right;\">0.0499765</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28373</td><td style = \"text-align: left;\">hsa-miR-221-3p</td><td style = \"text-align: left;\">hsa-miR-424-5p</td><td style = \"text-align: right;\">0.847972</td><td style = \"text-align: right;\">0.0499801</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28374</td><td style = \"text-align: left;\">hsa-miR-27b-5p</td><td style = \"text-align: left;\">hsa-miR-4424-3p</td><td style = \"text-align: right;\">0.847958</td><td style = \"text-align: right;\">0.0499837</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28375</td><td style = \"text-align: left;\">hsa-miR-629-5p</td><td style = \"text-align: left;\">hsa-miR-5096-5p</td><td style = \"text-align: right;\">0.847952</td><td style = \"text-align: right;\">0.0499873</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28376</td><td style = \"text-align: left;\">hsa-miR-181c-3p</td><td style = \"text-align: left;\">hsa-miR-374b-5p</td><td style = \"text-align: right;\">0.847946</td><td style = \"text-align: right;\">0.0499909</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28377</td><td style = \"text-align: left;\">hsa-miR-3688-2-3p</td><td style = \"text-align: left;\">hsa-miR-1260b-5p</td><td style = \"text-align: right;\">0.847943</td><td style = \"text-align: right;\">0.0499945</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">28378</td><td style = \"text-align: left;\">hsa-let-7d-5p</td><td style = \"text-align: left;\">hsa-miR-142-3p</td><td style = \"text-align: right;\">0.847937</td><td style = \"text-align: right;\">0.0499981</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nBioFindr computes a [posterior probability](https://tmichoel.github.io/BioFindr.jl/dev/posteriorprobs/) of non-zero correlation for every **Source** and **Target** gene pair. By default the output is sorted by decreasing **Probability** and self-interactions are excluded. The optional parameter **FDR** can be used to limit the output to the set of pairs that has a [global false discovery rate (FDR)](https://en.wikipedia.org/wiki/False_discovery_rate#Storey-Tibshirani_procedure) less than a desired value. The **qvalue** column in the output can be used for further filtering of the output. Say you ran findr with an FRD threshold of 5% as above. If you now want to restrict the output to an FDR threshold of 1%, you can do:\n\n::: {#f09ab070 .cell execution_count=6}\n``` {.julia .cell-code}\nfilter!(row -> row.qvalue <= 0.01, dP_mir_all)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div><div style = \"float: left;\"><span>14556×4 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">14531 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Source</th><th style = \"text-align: left;\">Target</th><th style = \"text-align: left;\">Probability</th><th style = \"text-align: left;\">qvalue</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">hsa-miR-574-3p</td><td style = \"text-align: left;\">hsa-miR-574-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">hsa-miR-4482-1-3p</td><td style = \"text-align: left;\">hsa-miR-1304-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">hsa-miR-3667-5p</td><td style = \"text-align: left;\">hsa-miR-3667-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">hsa-miR-550a-2-5p</td><td style = \"text-align: left;\">hsa-miR-550a-2-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">hsa-miR-550a-2-5p</td><td style = \"text-align: left;\">hsa-miR-550a-3-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">hsa-miR-3130-2-5p</td><td style = \"text-align: left;\">hsa-miR-3130-1-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">hsa-let-7b-5p</td><td style = \"text-align: left;\">hsa-let-7b-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">hsa-miR-96-5p</td><td style = \"text-align: left;\">hsa-miR-182-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">hsa-miR-96-5p</td><td style = \"text-align: left;\">hsa-miR-1271-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">hsa-miR-3667-3p</td><td style = \"text-align: left;\">hsa-miR-3667-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">hsa-miR-181c-5p</td><td style = \"text-align: left;\">hsa-miR-181c-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">hsa-miR-181c-5p</td><td style = \"text-align: left;\">hsa-miR-181d-5p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">hsa-miR-335-5p</td><td style = \"text-align: left;\">hsa-miR-335-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14545</td><td style = \"text-align: left;\">hsa-miR-4662a-5p</td><td style = \"text-align: left;\">hsa-miR-486-5p</td><td style = \"text-align: right;\">0.961667</td><td style = \"text-align: right;\">0.0099779</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14546</td><td style = \"text-align: left;\">hsa-miR-181b-1-3p</td><td style = \"text-align: left;\">hsa-miR-3609-3p</td><td style = \"text-align: right;\">0.961654</td><td style = \"text-align: right;\">0.00997985</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14547</td><td style = \"text-align: left;\">hsa-miR-23a-5p</td><td style = \"text-align: left;\">hsa-miR-150-5p</td><td style = \"text-align: right;\">0.961633</td><td style = \"text-align: right;\">0.0099818</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14548</td><td style = \"text-align: left;\">hsa-miR-500a-3p</td><td style = \"text-align: left;\">hsa-miR-138-1-3p</td><td style = \"text-align: right;\">0.961624</td><td style = \"text-align: right;\">0.00998375</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14549</td><td style = \"text-align: left;\">hsa-miR-425-3p</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: right;\">0.961621</td><td style = \"text-align: right;\">0.00998571</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14550</td><td style = \"text-align: left;\">hsa-miR-125a-5p</td><td style = \"text-align: left;\">hsa-miR-140-3p</td><td style = \"text-align: right;\">0.961608</td><td style = \"text-align: right;\">0.00998766</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14551</td><td style = \"text-align: left;\">hsa-miR-342-5p</td><td style = \"text-align: left;\">hsa-miR-335-5p</td><td style = \"text-align: right;\">0.961607</td><td style = \"text-align: right;\">0.00998961</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14552</td><td style = \"text-align: left;\">hsa-miR-3615-3p</td><td style = \"text-align: left;\">hsa-miR-744-5p</td><td style = \"text-align: right;\">0.9616</td><td style = \"text-align: right;\">0.00999156</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14553</td><td style = \"text-align: left;\">hsa-miR-320d-1-3p</td><td style = \"text-align: left;\">hsa-miR-365a-5p</td><td style = \"text-align: right;\">0.961596</td><td style = \"text-align: right;\">0.00999351</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14554</td><td style = \"text-align: left;\">hsa-miR-23a-5p</td><td style = \"text-align: left;\">hsa-miR-425-5p</td><td style = \"text-align: right;\">0.961593</td><td style = \"text-align: right;\">0.00999547</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14555</td><td style = \"text-align: left;\">hsa-miR-26b-3p</td><td style = \"text-align: left;\">hsa-miR-4687-3p</td><td style = \"text-align: right;\">0.961592</td><td style = \"text-align: right;\">0.00999742</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">14556</td><td style = \"text-align: left;\">hsa-miR-589-5p</td><td style = \"text-align: left;\">hsa-miR-644b-3p</td><td style = \"text-align: right;\">0.96159</td><td style = \"text-align: right;\">0.00999937</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nNote that the [`filter!`](https://dataframes.juliadata.org/stable/lib/functions/#Base.filter!) command modifies the input DataFrame in-place, that is, the rows not matching the selection criteria are deleted. Use [`filter`](https://dataframes.juliadata.org/stable/lib/functions/#Base.filter) to return a new DataFrame with the selected rows.\n\nFinally, remember that the output of coexpression analysis in BioFindr is *not* symmetric, that is\n\n$$\nP(Source, Target) \\neq P(Target, Source)\n$$\n\nThis is because the posterior probabilities are estimated using a Source-specific background distribution, accounting for the fact that different genes may have a different number of non-null interaction partners *a priori*. See the [Findr paper][5] for details.\n\n### Bipartite coexpression analysis\n\nSince BioFindr's posterior probabilities are Source gene-specific, we may be interested in computing probabilities only for a subset of Source genes, or using different Source and Target gene sets. \n\nAs an example of the first scenario, assume we are interested in finding microRNAs that are significantly correlated with microRNAs from the [Mir-200 family](https://en.wikipedia.org/wiki/Mir-200). First find the Mir-200 microRNAs:\n\n::: {#1798959e .cell execution_count=7}\n``` {.julia .cell-code}\nmir200 = names(dm)[startswith.(names(dm),\"hsa-miR-200\")]\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n3-element Vector{String}:\n \"hsa-miR-200b-3p\"\n \"hsa-miR-200a-3p\"\n \"hsa-miR-200c-3p\"\n```\n:::\n:::\n\n\nThen run\n\n::: {#6f0ce5e3 .cell execution_count=8}\n``` {.julia .cell-code}\ndP_mir200_mir = findr(dm, colnames=mir200, FDR=0.01)\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div><div style = \"float: left;\"><span>47×4 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">22 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Source</th><th style = \"text-align: left;\">Target</th><th style = \"text-align: left;\">Probability</th><th style = \"text-align: left;\">qvalue</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">hsa-miR-200a-3p</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">1.39181e-9</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: left;\">hsa-miR-200a-3p</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">1.55254e-9</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-93-5p</td><td style = \"text-align: right;\">0.999998</td><td style = \"text-align: right;\">5.68454e-7</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-140-3p</td><td style = \"text-align: right;\">0.999984</td><td style = \"text-align: right;\">4.44472e-6</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: left;\">hsa-miR-429-3p</td><td style = \"text-align: right;\">0.999918</td><td style = \"text-align: right;\">1.99874e-5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-16-1-5p</td><td style = \"text-align: right;\">0.999792</td><td style = \"text-align: right;\">5.13862e-5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-664-3p</td><td style = \"text-align: right;\">0.999784</td><td style = \"text-align: right;\">7.49279e-5</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-17-5p</td><td style = \"text-align: right;\">0.999641</td><td style = \"text-align: right;\">0.000110395</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: left;\">hsa-miR-582-3p</td><td style = \"text-align: right;\">0.999246</td><td style = \"text-align: right;\">0.00018188</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-769-5p</td><td style = \"text-align: right;\">0.999242</td><td style = \"text-align: right;\">0.000239459</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-130b-5p</td><td style = \"text-align: right;\">0.999139</td><td style = \"text-align: right;\">0.000295921</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-425-5p</td><td style = \"text-align: right;\">0.999052</td><td style = \"text-align: right;\">0.000350225</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-103a-2-3p</td><td style = \"text-align: right;\">0.999001</td><td style = \"text-align: right;\">0.000400161</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">36</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: left;\">hsa-miR-769-3p</td><td style = \"text-align: right;\">0.983749</td><td style = \"text-align: right;\">0.00628075</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">37</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-378a-3p</td><td style = \"text-align: right;\">0.983227</td><td style = \"text-align: right;\">0.00656431</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">38</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: left;\">hsa-miR-26b-5p</td><td style = \"text-align: right;\">0.981109</td><td style = \"text-align: right;\">0.00688869</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">39</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-619-5p</td><td style = \"text-align: right;\">0.980948</td><td style = \"text-align: right;\">0.00720056</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">40</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-500a-5p</td><td style = \"text-align: right;\">0.97978</td><td style = \"text-align: right;\">0.00752605</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">41</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-4677-3p</td><td style = \"text-align: right;\">0.979595</td><td style = \"text-align: right;\">0.00784016</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">42</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: left;\">hsa-miR-328-3p</td><td style = \"text-align: right;\">0.979019</td><td style = \"text-align: right;\">0.00815303</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">43</td><td style = \"text-align: left;\">hsa-miR-200b-3p</td><td style = \"text-align: left;\">hsa-miR-9-1-5p</td><td style = \"text-align: right;\">0.978721</td><td style = \"text-align: right;\">0.00845829</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">44</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-141-5p</td><td style = \"text-align: right;\">0.978487</td><td style = \"text-align: right;\">0.00875499</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">45</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-30e-3p</td><td style = \"text-align: right;\">0.977855</td><td style = \"text-align: right;\">0.00905255</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">46</td><td style = \"text-align: left;\">hsa-miR-200a-3p</td><td style = \"text-align: left;\">hsa-miR-26b-5p</td><td style = \"text-align: right;\">0.976313</td><td style = \"text-align: right;\">0.0093707</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">47</td><td style = \"text-align: left;\">hsa-miR-200c-3p</td><td style = \"text-align: left;\">hsa-miR-25-3p</td><td style = \"text-align: right;\">0.971038</td><td style = \"text-align: right;\">0.00978752</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nThe parameter **colnames** must be a vector of strings containing a subset of variable names of the input DataFrame **dm** to be used as **Source** genes.\n\nAs an example of the second scenario, we may be interested in finding genes that are significantly correlated with all or a subset of microRNAs: \n\n::: {#111b1c0a .cell execution_count=9}\n``` {.julia .cell-code}\ndP_mir_mrna = findr(dt, dm, FDR=0.01)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div><div style = \"float: left;\"><span>56268×4 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">56243 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Source</th><th style = \"text-align: left;\">Target</th><th style = \"text-align: left;\">Probability</th><th style = \"text-align: left;\">qvalue</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">hsa-miR-3150b-3p</td><td style = \"text-align: left;\">ENSG00000245080.3</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">hsa-let-7b-5p</td><td style = \"text-align: left;\">ENSG00000197182.8</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">hsa-let-7b-5p</td><td style = \"text-align: left;\">ENSG00000241990.1</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">hsa-miR-335-5p</td><td style = \"text-align: left;\">ENSG00000106484.8</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">hsa-miR-335-5p</td><td style = \"text-align: left;\">ENSG00000128510.5</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">hsa-miR-335-5p</td><td style = \"text-align: left;\">ENSG00000220884.2</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">hsa-miR-618-5p</td><td style = \"text-align: left;\">ENSG00000111052.3</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">hsa-miR-335-3p</td><td style = \"text-align: left;\">ENSG00000106484.8</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">hsa-miR-335-3p</td><td style = \"text-align: left;\">ENSG00000128510.5</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">hsa-miR-335-3p</td><td style = \"text-align: left;\">ENSG00000220884.2</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">hsa-let-7b-3p</td><td style = \"text-align: left;\">ENSG00000241990.1</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">hsa-miR-138-1-3p</td><td style = \"text-align: left;\">ENSG00000261786.1</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">hsa-miR-138-1-5p</td><td style = \"text-align: left;\">ENSG00000261786.1</td><td style = \"text-align: right;\">1.0</td><td style = \"text-align: right;\">0.0</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56257</td><td style = \"text-align: left;\">hsa-miR-3909-3p</td><td style = \"text-align: left;\">ENSG00000143028.7</td><td style = \"text-align: right;\">0.973468</td><td style = \"text-align: right;\">0.00999676</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56258</td><td style = \"text-align: left;\">hsa-miR-193b-3p</td><td style = \"text-align: left;\">ENSG00000198833.5</td><td style = \"text-align: right;\">0.973467</td><td style = \"text-align: right;\">0.00999706</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56259</td><td style = \"text-align: left;\">hsa-miR-148a-3p</td><td style = \"text-align: left;\">ENSG00000112697.10</td><td style = \"text-align: right;\">0.973467</td><td style = \"text-align: right;\">0.00999735</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56260</td><td style = \"text-align: left;\">hsa-miR-425-3p</td><td style = \"text-align: left;\">ENSG00000072195.9</td><td style = \"text-align: right;\">0.973467</td><td style = \"text-align: right;\">0.00999764</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56261</td><td style = \"text-align: left;\">hsa-miR-210-5p</td><td style = \"text-align: left;\">ENSG00000013503.4</td><td style = \"text-align: right;\">0.973466</td><td style = \"text-align: right;\">0.00999794</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56262</td><td style = \"text-align: left;\">hsa-miR-625-5p</td><td style = \"text-align: left;\">ENSG00000214121.3</td><td style = \"text-align: right;\">0.973465</td><td style = \"text-align: right;\">0.00999823</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56263</td><td style = \"text-align: left;\">hsa-miR-1301-3p</td><td style = \"text-align: left;\">ENSG00000231752.1</td><td style = \"text-align: right;\">0.973465</td><td style = \"text-align: right;\">0.00999853</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56264</td><td style = \"text-align: left;\">hsa-miR-582-5p</td><td style = \"text-align: left;\">ENSG00000231752.1</td><td style = \"text-align: right;\">0.973463</td><td style = \"text-align: right;\">0.00999882</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56265</td><td style = \"text-align: left;\">hsa-miR-132-3p</td><td style = \"text-align: left;\">ENSG00000158406.2</td><td style = \"text-align: right;\">0.973463</td><td style = \"text-align: right;\">0.00999911</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56266</td><td style = \"text-align: left;\">hsa-miR-196a-2-5p</td><td style = \"text-align: left;\">ENSG00000229446.1</td><td style = \"text-align: right;\">0.973462</td><td style = \"text-align: right;\">0.00999941</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56267</td><td style = \"text-align: left;\">hsa-miR-29b-1-5p</td><td style = \"text-align: left;\">ENSG00000188010.8</td><td style = \"text-align: right;\">0.973461</td><td style = \"text-align: right;\">0.0099997</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">56268</td><td style = \"text-align: left;\">hsa-miR-125a-5p</td><td style = \"text-align: left;\">ENSG00000047932.9</td><td style = \"text-align: right;\">0.973461</td><td style = \"text-align: right;\">0.01</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nNote the order of the arguments: here we tested all microRNAs as $A$ or Source genes (`dm` argument) against all mRNA transcripts as $B$ or Target genes (`dt` argument), that is, background distributions are fitted for each microRNA (column of `dm`) from the log-likelihood ratios for all 23,722 mRNAs (columns of `dt`).\n\n[1]: https://github.com/tmichoel/BioFindr.jl\n[2]: https://github.com/lingfeiwang/findr-data-geuvadis\n[3]: https://doi.org/10.1038/nature12531\n[4]: https://dataframes.juliadata.org/stable/\n[5]: https://doi.org/10.1371/journal.pcbi.1005703\n\n---\njupyter:\n  kernelspec:\n    display_name: Julia 1.9.0\n    language: julia\n    name: julia-1.7\n  language_info:\n    file_extension: .jl\n    mimetype: application/julia\n    name: julia\n    version: 1.9.0\n---\n",
    "supporting": [
      "coexpression_files\\figure-ipynb"
    ],
    "filters": []
  }
}